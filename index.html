<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Focus Pomodoro</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --frame: #181718;
      --bg-soft: #111827;
      --accent: #3b82f6;
      --accent-soft: rgba(59, 130, 246, 0.15);
      --text: #e5e7eb;
      --text-soft: #9ca3af;
      --radius-xl: 18px;
      --radius-lg: 12px;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      background: #181718;
      color: var(--text);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 8px;
    }

    .app {
      width: 100%;
      max-width: 480px;
      background: #181718;
      border-radius: 24px;
      padding: 8px;
      border: 1px solid var(--frame);
    }

    .app-header {
      margin-bottom: 8px;
    }

    .app-title {
      font-size: 16px;
      font-weight: 600;
      display: flex;
      gap: 8px;
      align-items: center;
    }

    .app-title span.logo-dot {
      width: 10px;
      height: 10px;
      border-radius: 999px;
      background: var(--accent);
    }

    .mode-switch {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 6px;
      background: rgba(15, 23, 42, 0.9);
      border-radius: var(--radius-lg);
      padding: 4px;
      border: 1px solid rgba(148, 163, 184, 0.2);
      margin-bottom: 8px;
    }

    .mode-btn {
      font-size: 11px;
      border: none;
      border-radius: 999px;
      padding: 6px 4px;
      background: transparent;
      color: var(--text-soft);
      cursor: pointer;
    }

    .mode-btn.active {
      background: var(--accent-soft);
      color: var(--accent);
      font-weight: 500;
    }

    .timer-card {
      background: radial-gradient(circle at top, rgba(37, 99, 235, 0.3), rgba(3, 7, 18, 1));
      border-radius: 22px;
      padding: 16px;
      border: 1px solid rgba(37, 99, 235, 0.3);
      position: relative;
    }

    /* Fila superior: modo, contador centrado, botones */
    .timer-top {
      display: grid;
      grid-template-columns: auto 1fr auto;
      align-items: center;
      margin-bottom: 10px;
      column-gap: 16px;
    }

    .timer-label {
      font-size: 12px;
      color: var(--text-soft);
    }

    .session-counter {
      font-size: 12px;
      color: var(--text-soft);
      text-align: center; /* SIEMPRE centrado */
    }

    .timer-actions {
      display: flex;
      gap: 6px;
    }

    .timer-display {
      font-size: 52px;
      font-weight: 600;
      text-align: center;
      margin: 6px 0;
    }

    .timer-status {
      font-size: 11px;
      text-align: center;
      color: var(--text-soft);
      margin-bottom: 10px;
    }

    .progress-bar {
      width: 100%;
      height: 5px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.8);
      margin-bottom: 6px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      width: 100%;
      transform-origin: left;
      transform: scaleX(1);
      background: linear-gradient(90deg, #22c55e, #3b82f6);
    }

    .controls {
      display: flex;
      gap: 8px;
      margin-bottom: 6px;
    }

    .btn {
      flex: 1;
      height: 38px;
      border-radius: 999px;
      font-size: 14px;
      border: none;
      cursor: pointer;
    }

    .btn-primary {
      background: var(--accent);
      color: #0d1117;
    }

    .btn-secondary {
      background: #0f172a;
      color: var(--text-soft);
      border: 1px solid #1f2937;
    }

    /* Botones superiores */
    .icon-btn {
      width: 28px;
      height: 28px;
      border-radius: 6px;
      background: #0f1e44;
      border: 1px solid #1d4ed8;
      color: #93c5fd;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 15px;
      cursor: pointer;
      transition: background 0.15s ease, color 0.15s ease;
      box-shadow: none !important;
    }

    .icon-btn:hover {
      background: #1e3a8a;
      color: #ffffff;
    }

    .pill {
      font-size: 10px;
      padding: 4px 6px;
      border-radius: 999px;
      background: #0f172a;
      border: 1px solid #1f2937;
      color: var(--text-soft);
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .footer {
      margin-top: 4px;
      font-size: 10px;
      color: var(--text-soft);
      display: flex;
      justify-content: space-between;
    }

    .settings-modal {
      position: absolute;
      inset: 0;
      background: rgba(0,0,0,0.5);
      display: none;
      align-items: center;
      justify-content: center;
    }

    .settings-modal.open {
      display: flex;
    }

    .settings-modal-content {
      background: #020617;
      padding: 16px;
      border-radius: 14px;
      width: 100%;
      max-width: 300px;
      border: 1px solid rgba(148,163,184,0.4);
    }

    .settings-modal-content h4 {
      margin-bottom: 8px;
      color: #e5e7eb;
      font-size: 14px;
    }

    .settings-input {
      width: 100%;
      margin-top: 4px;
      margin-bottom: 8px;
      padding: 6px;
      border-radius: 8px;
      background: #0f172a;
      border: 1px solid #1f2937;
      color: white;
      text-align: center;
    }
  </style>
</head>
<body>

  <div class="app">

    <header class="app-header">
      <div class="app-title">
        <span class="logo-dot"></span>
        <span>Focus Pomodoro</span>
      </div>
    </header>

    <div class="mode-switch" id="mode-switch">
      <button class="mode-btn active" data-mode="focus">Trabajo</button>
      <button class="mode-btn" data-mode="short">Pausa corta</button>
      <button class="mode-btn" data-mode="long">Pausa larga</button>
    </div>

    <section class="timer-card">

      <div class="timer-top">
        <div class="timer-label" id="mode-label">Sesión de trabajo</div>

        <div class="session-counter" id="session-counter">
          Pomodoros completados: 0
        </div>

        <div class="timer-actions">
          <button class="icon-btn" id="btn-next">▶▶</button>
          <button class="icon-btn" id="btn-config">⚙</button>
        </div>
      </div>

      <div class="timer-display" id="timer-display">25:00</div>
      <div class="timer-status" id="timer-status">Listo para comenzar</div>

      <div class="progress-bar">
        <div class="progress-fill" id="progress-fill"></div>
      </div>

      <div class="controls">
        <button class="btn btn-primary" id="btn-toggle">▶ Iniciar</button>
        <button class="btn btn-secondary" id="btn-reset">↺ Reiniciar</button>
      </div>

      <label class="pill">
        <input type="checkbox" id="auto-continue" checked />
        Auto continuar
      </label>

      <footer class="footer">
        <span>Tip: 4 pomodoros → pausa larga</span>
        <span id="today-info"></span>
      </footer>

      <div class="settings-modal" id="settings-modal">
        <div class="settings-modal-content">
          <h4>Ajustes</h4>

          <label>Trabajo (min)
            <input class="settings-input" type="number" id="focus-min" value="25" min="1">
          </label>

          <label>Pausa corta (min)
            <input class="settings-input" type="number" id="short-min" value="5" min="1">
          </label>

          <label>Pausa larga (min)
            <input class="settings-input" type="number" id="long-min" value="15" min="1">
          </label>
        </div>
      </div>

    </section>
  </div>

<script>

  const MODES = {
    focus: { label:"Sesión de trabajo" },
    short: { label:"Pausa corta" },
    long:  { label:"Pausa larga" }
  };

  const modesOrder = ["focus","short","long"];

  const modeButtons = document.querySelectorAll(".mode-btn");
  const modeLabel   = document.getElementById("mode-label");
  const sessionCounter = document.getElementById("session-counter");
  const displayEl   = document.getElementById("timer-display");
  const statusEl    = document.getElementById("timer-status");
  const progressFill= document.getElementById("progress-fill");
  const btnToggle   = document.getElementById("btn-toggle");
  const btnReset    = document.getElementById("btn-reset");
  const autoContinue= document.getElementById("auto-continue");
  const nextBtn     = document.getElementById("btn-next");
  const configBtn   = document.getElementById("btn-config");
  const settingsModal = document.getElementById("settings-modal");
  const focusInput  = document.getElementById("focus-min");
  const shortInput  = document.getElementById("short-min");
  const longInput   = document.getElementById("long-min");
  const todayInfo   = document.getElementById("today-info");

  let currentMode = "focus";
  let totalSeconds = 25*60;
  let remainingSeconds = totalSeconds;
  let timerId = null;
  let isRunning = false;
  let completedPomodoros = 0;

  // --- SONIDO PERSONALIZADO ---
  // Asegúrate de subir el archivo a GitHub como "pomodoro-beep.mp3"
  const beepAudio = new Audio("pomodoro-beep.mp3");
  beepAudio.volume = 1.0;

  function playBeep() {
    try {
      beepAudio.currentTime = 0;
      beepAudio.play().catch(()=>{});
    } catch (e) {
      console.error("Error reproduciendo el sonido:", e);
    }
  }

  function setToday() {
    const now = new Date();
    const fmt = new Intl.DateTimeFormat("es-PE", {
      weekday: "short",
      day: "2-digit",
      month: "short"
    });
    todayInfo.textContent = fmt.format(now);
  }

  function setMode(mode){
    currentMode = mode;
    modeButtons.forEach(b => b.classList.toggle("active", b.dataset.mode===mode));

    let m = (mode==="focus") ? Number(focusInput.value || 25) :
            (mode==="short") ? Number(shortInput.value || 5) :
            Number(longInput.value || 15);

    if (m < 1) m = 1;

    totalSeconds = m * 60;
    remainingSeconds = totalSeconds;

    modeLabel.textContent = MODES[mode].label;
    statusEl.textContent = "Listo para comenzar";
    updateDisplay();
  }

  function updateDisplay(){
    const m = Math.floor(remainingSeconds/60);
    const s = remainingSeconds%60;
    displayEl.textContent =
      (m<10?"0":"")+m+":"+(s<10?"0":"")+s;

    const ratio = totalSeconds > 0 ? remainingSeconds/totalSeconds : 0;
    progressFill.style.transform = "scaleX("+ratio+")";
  }

  function startTimer(){
    if(isRunning) return;
    isRunning = true;
    btnToggle.textContent = "⏸ Pausar";
    statusEl.textContent = "En curso...";

    timerId = setInterval(()=>{
      remainingSeconds--;
      if(remainingSeconds <= 0){
        clearInterval(timerId);
        isRunning = false;
        remainingSeconds = 0;
        updateDisplay();
        statusEl.textContent = "¡Tiempo cumplido!";
        
        playBeep();  // SUENA TU ARCHIVO PERSONALIZADO

        if(currentMode === "focus"){
          completedPomodoros++;
          sessionCounter.textContent =
            "Pomodoros completados: " + completedPomodoros;
        }

        if(autoContinue.checked){
          if(currentMode==="focus") setMode("short");
          else setMode("focus");
          startTimer();
        }
        return;
      }
      updateDisplay();
    },1000);
  }

  function pauseTimer(){
    clearInterval(timerId);
    isRunning = false;
    btnToggle.textContent = "▶ Reanudar";
    statusEl.textContent = "Pausado";
  }

  function resetTimer(){
    clearInterval(timerId);
    isRunning = false;
    btnToggle.textContent = "▶ Iniciar";
    setMode(currentMode);
  }

  btnToggle.onclick = ()=>{
    if(isRunning) pauseTimer();
    else startTimer();
  };

  btnReset.onclick = ()=>resetTimer();

  modeButtons.forEach(btn=>{
    btn.onclick = ()=>{
      resetTimer();
      setMode(btn.dataset.mode);
    };
  });

  nextBtn.onclick = ()=>{
    const idx = modesOrder.indexOf(currentMode);
    const next = modesOrder[(idx+1) % modesOrder.length];
    resetTimer();
    setMode(next);
  };

  configBtn.onclick = ()=>{
    settingsModal.classList.toggle("open");
  };

  settingsModal.onclick = e=>{
    if(e.target === settingsModal){
      settingsModal.classList.remove("open");
    }
  };

  [focusInput, shortInput, longInput].forEach(inp=>{
    inp.addEventListener("change", ()=>{
      if(inp.value < 1) inp.value = 1;
      setMode(currentMode);
    });
  });

  setToday();
  setMode("focus");
</script>

</body>
</html>
